# 浅析计算机存储系统：从磁盘到内存

    本文涉及到的 Linux 内核版本为2.4+

## 前言

把一个计算机系统模型高度简化之后来看的话其实一共就只有两个部分，一个是cpu，用于执行各种指令，另一个是存储器系统为cpu存放指令和数据。对一只普通小码农而言，日常工作中基本上是没什么机会和cpu打交道的，而对于经常打交道的同时也是对程序性能有着极大影响的存储系统更多的时候是处于一种一知半解的状态，就是知道很多碎片化的知识，但是相互之间不能够很好地串起来，从而形成一个比较完整的了解，比如如下的一些场景：

1. 我们或许知道在进程运行过程中删除了文件但是用df命令去看会发现磁盘空间并不会被释放，那么我们能说清楚这个现象的原因吗？以及删除文件的这个操作具体都删除了什么东西呢？还有所谓的磁盘空间又是个什么东西呢？
2. 作为一个java程序员，我们肯定都知道堆内内存，堆外内存，直接内存巴拉巴拉等一系列jvm中和内存相关的概念，那么这些内存和所谓的物理内存之间又是什么关系呢？如果用了1G的堆内存那么也会占用1G的物理内存吗？如果虚拟机回收了1G的堆内存那么物理内存也会被释放掉吗？堆内存是由虚拟机来进行垃圾回收的，那物理内存又是谁以及如何分配和回收的呢？

为了真正搞懂上面的这些问题，同时也为了把一些碎片知识串起来，专门花了几个周末的时间查阅了相关的一些资料和源码，基本上对于存储系统这一块有了一个整体的了解，当然能够说出来才谈得上了解，所以打算就这部分内存整理一篇文章出来，也就是本文。

## 存储器层次结构

要弄明白存储系统首先得对存储器有一些基本的了解，现代计算机的存储系统是由具有不同容量/成本/访问时间的存储器组合在一起形成的一个层次结构，按照相对CPU距离的远近存储器可以被划分为:寄存器/高速缓存/主存/磁盘/其他,其中寄存器和高速缓存都位于CPU中，像我们写汇编时会用到的rsp就是X68_64架构下的16个通用寄存器之一，

## 文件系统


## 内存管理
### linux内存管理
### JVM 内存管理

## 总结

ok，要写的内容基本上就写完了，现在是时候来填在文章开头埋的坑了，也就是前言里面提到的那几个问题的答案。

1. 为什么删除文件后磁盘空间未被释放

        todo
2. 删除文件都删除的是什么东西

        todo
3. 磁盘空间是指什么
        
        todo

4. 堆内存和物理内存的关系

        todo
5. 物理内存的分配回收策略

        todo